<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Evaluaci√≥n Integral C++ - RAP1 a RAP4</title>
  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body { 
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      padding: 20px;
      color: #333;
    }

    .container {
      max-width: 1200px;
      margin: 0 auto;
      background: white;
      border-radius: 15px;
      box-shadow: 0 20px 40px rgba(0,0,0,0.1);
      overflow: hidden;
    }

    .header {
      background: linear-gradient(135deg, #2c3e50, #34495e);
      color: white;
      text-align: center;
      padding: 30px;
    }

    .header h2 {
      font-size: 2.2em;
      margin-bottom: 10px;
      font-weight: 300;
    }

    .header p {
      font-size: 1.1em;
      opacity: 0.9;
    }

    .content {
      padding: 30px;
    }

    .hidden { 
      display: none; 
    }

    /* Formulario inicial */
    .form-group {
      margin-bottom: 20px;
    }

    .form-group label {
      display: block;
      margin-bottom: 8px;
      font-weight: 600;
      color: #2c3e50;
    }

    .form-group input[type="text"] {
      width: 100%;
      padding: 12px 15px;
      border: 2px solid #e1e8ed;
      border-radius: 8px;
      font-size: 16px;
      transition: border-color 0.3s ease;
    }

    .form-group input[type="text"]:focus {
      outline: none;
      border-color: #667eea;
      box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
    }

    /* Botones */
    .btn {
      background: linear-gradient(135deg, #667eea, #764ba2);
      color: white;
      border: none;
      padding: 15px 30px;
      border-radius: 8px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      display: inline-block;
      text-decoration: none;
    }

    .btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 10px 20px rgba(0,0,0,0.2);
    }

    .btn:active {
      transform: translateY(0);
    }

    .btn-success {
      background: linear-gradient(135deg, #56ab2f, #a8e6cf);
    }

    .btn-danger {
      background: linear-gradient(135deg, #ff416c, #ff4b2b);
    }

    /* Secciones RAP */
    .rap-section {
      background: #f8f9fa;
      border-radius: 12px;
      padding: 25px;
      margin-bottom: 30px;
      border-left: 5px solid;
    }

    .rap-section.rap1 { border-left-color: #e74c3c; }
    .rap-section.rap2 { border-left-color: #f39c12; }
    .rap-section.rap3 { border-left-color: #3498db; }
    .rap-section.rap4 { border-left-color: #2ecc71; }

    .rap-header {
      display: flex;
      align-items: center;
      margin-bottom: 20px;
      padding-bottom: 15px;
      border-bottom: 2px solid #ecf0f1;
    }

    .rap-icon {
      width: 50px;
      height: 50px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.5em;
      font-weight: bold;
      color: white;
      margin-right: 15px;
    }

    .rap1 .rap-icon { background: #e74c3c; }
    .rap2 .rap-icon { background: #f39c12; }
    .rap3 .rap-icon { background: #3498db; }
    .rap4 .rap-icon { background: #2ecc71; }

    .rap-title {
      font-size: 1.4em;
      font-weight: 600;
      color: #2c3e50;
    }

    .rap-description {
      font-size: 0.9em;
      color: #7f8c8d;
      margin-top: 5px;
    }

    /* Preguntas */
    .question {
      background: white;
      border-radius: 8px;
      padding: 20px;
      margin-bottom: 20px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.05);
      border: 1px solid #e1e8ed;
      transition: all 0.3s ease;
    }

    .question:hover {
      box-shadow: 0 5px 20px rgba(0,0,0,0.1);
      transform: translateY(-2px);
    }

    .question.error {
      border-color: #e74c3c;
      background: #fdf2f2;
    }

    .question-number {
      background: linear-gradient(135deg, #667eea, #764ba2);
      color: white;
      width: 30px;
      height: 30px;
      border-radius: 50%;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      font-weight: bold;
      margin-right: 15px;
      font-size: 14px;
    }

    .question-text {
      font-size: 1.1em;
      font-weight: 600;
      color: #2c3e50;
      margin-bottom: 15px;
      line-height: 1.5;
    }

    .options {
      display: grid;
      gap: 10px;
    }

    .option {
      display: flex;
      align-items: center;
      padding: 12px 15px;
      background: #f8f9fa;
      border-radius: 6px;
      cursor: pointer;
      transition: all 0.3s ease;
      border: 2px solid transparent;
    }

    .option:hover {
      background: #e9ecef;
      transform: translateX(5px);
    }

    .option.selected {
      background: #e3f2fd;
      border-color: #2196f3;
    }

    .option input[type="radio"] {
      margin-right: 12px;
      transform: scale(1.2);
    }

    .option label {
      cursor: pointer;
      flex: 1;
      font-size: 1em;
      color: #495057;
    }

    /* Progreso */
    .progress-bar {
      background: #e9ecef;
      height: 8px;
      border-radius: 4px;
      margin: 20px 0;
      overflow: hidden;
    }

    .progress-fill {
      height: 100%;
      background: linear-gradient(90deg, #667eea, #764ba2);
      transition: width 0.3s ease;
      border-radius: 4px;
    }

    .progress-text {
      text-align: center;
      margin-top: 10px;
      font-weight: 600;
      color: #6c757d;
    }

    /* Resultado */
    .result-card {
      background: white;
      border-radius: 12px;
      padding: 30px;
      text-align: center;
      box-shadow: 0 10px 30px rgba(0,0,0,0.1);
    }

    .result-score {
      font-size: 3em;
      font-weight: bold;
      margin: 20px 0;
    }

    .result-score.pass { color: #2ecc71; }
    .result-score.fail { color: #e74c3c; }

    .result-status {
      font-size: 1.5em;
      font-weight: 600;
      margin-bottom: 20px;
    }

    .result-status.pass { color: #2ecc71; }
    .result-status.fail { color: #e74c3c; }

    /* Ejercicios */
    .exercises {
      background: #f8f9fa;
      border-radius: 12px;
      padding: 25px;
      margin-top: 30px;
    }

    .exercises h3 {
      color: #2c3e50;
      margin-bottom: 20px;
      font-size: 1.3em;
    }

    .exercises ol {
      padding-left: 20px;
    }

    .exercises li {
      margin-bottom: 15px;
      line-height: 1.6;
      color: #495057;
    }

    /* Upload */
    .upload-section {
      background: #e8f5e8;
      border: 2px dashed #2ecc71;
      border-radius: 12px;
      padding: 30px;
      text-align: center;
      margin-top: 20px;
    }

    .upload-section h3 {
      color: #2ecc71;
      margin-bottom: 20px;
    }

    .upload-section input[type="file"] {
      margin: 15px 0;
      padding: 10px;
      border: 1px solid #ddd;
      border-radius: 6px;
    }

    /* Validaci√≥n */
    .validation-message {
      background: #fff3cd;
      border: 1px solid #ffeaa7;
      color: #856404;
      padding: 15px;
      border-radius: 8px;
      margin: 20px 0;
      display: none;
    }

    .validation-message.show {
      display: block;
    }

    /* Responsive */
    @media (max-width: 768px) {
      .content {
        padding: 15px;
      }
      
      .question-text {
        font-size: 1em;
      }
      
      .result-score {
        font-size: 2.5em;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h2>Evaluaci√≥n Integral C++</h2>
      <p>Prueba de Conocimientos RAP1 - RAP4</p>
    </div>

    <div class="content">
      <!-- Formulario inicial -->
 <div id="formulario">
        <div class="form-group">
          <label for="nombre">Nombre completo:</label>
          <input type="text" id="nombre" placeholder="Ingrese su nombre completo">
        </div>
        <div class="form-group">
          <label for="documento">N√∫mero de documento:</label>
          <input type="text" id="documento" placeholder="Ingrese su n√∫mero de documento">
        </div>
        <div class="form-group">
          <label for ="clave">Clave de acceso:</label>
          <input type="password" id="clave">
        </div>
        <button class="btn" onclick="iniciarQuiz()">Iniciar Evaluaci√≥n</button>
      </div>

      <!-- Quiz -->
      <div id="quiz" class="hidden">
        <div class="progress-bar">
          <div class="progress-fill" id="progressFill" style="width: 0%"></div>
        </div>
        <div class="progress-text" id="progressText">Pregunta 0 de 40</div>
        
        <div class="validation-message" id="validationMessage">
          <strong>¬°Atenci√≥n!</strong> Debe responder todas las preguntas antes de finalizar la evaluaci√≥n.
          <div id="missingQuestions"></div>
        </div>
        
        <div id="quizContent"></div>
        <button class="btn btn-success" onclick="finalizarQuiz()" style="margin-top: 30px;">Finalizar Evaluaci√≥n</button>
      </div>

      <!-- Resultado -->
      <div id="resultado" class="hidden"></div>

      <!-- Ejercicios -->
      <div id="ejercicios" class="hidden"></div>

      <!-- Upload -->
      <div id="upload" class="hidden">
        <div class="upload-section">
          <h3>üìÅ Sube tus ejercicios pr√°cticos</h3>
          <p>Comprima sus archivos en formato .zip o .rar</p>
          <form id="uploadForm" enctype="multipart/form-data" method="post" action="/upload">
            <input type="file" name="archivo" accept=".zip,.rar" required>
            <br>
            <button type="submit" class="btn">Subir Archivos</button>
          </form>
        </div>
      </div>
    </div>
  </div>

  <script>
    /* ================= RAP1 - Fundamentos ================= */
    const preguntasRAP1 = [
      { q: "¬øCu√°l es la funci√≥n principal obligatoria en C++?", opts: ["main()", "start()", "init()"], ans: "main()" },
      { q: "¬øQu√© librer√≠a se usa para entrada y salida est√°ndar en C++?", opts: ["&lt;stdio.h&gt;", "&lt;iostream&gt;", "&lt;math.h&gt;"], ans: "&lt;iostream&gt;" },
      { q: "¬øC√≥mo se define un comentario de una sola l√≠nea en C++?", opts: ["// comentario", "/* comentario */", "# comentario"], ans: "// comentario" },
      { q: "¬øCu√°l de los siguientes es un identificador v√°lido?", opts: ["1dato", "mi_variable", "nombre completo"], ans: "mi_variable" },
      { q: "¬øQu√© instrucci√≥n permite incluir librer√≠as?", opts: ["#define", "#include", "import"], ans: "#include" },
      { q: "¬øQu√© palabra reservada se usa para declarar una constante?", opts: ["const", "final", "let"], ans: "const" },
      { q: "¬øQu√© s√≠mbolo finaliza cada instrucci√≥n en C++?", opts: [".", ";", ":"], ans: ";" },
      { q: "¬øCu√°l es el tipo de dato adecuado para caracteres?", opts: ["int", "char", "string"], ans: "char" },
      { q: "¬øQu√© palabra reservada define una variable entera?", opts: ["float", "int", "double"], ans: "int" },
      { q: "¬øQu√© tipo de variable existe solo dentro de una funci√≥n?", opts: ["Global", "Local", "Est√°tica"], ans: "Local" },
      { q: "¬øCu√°l de estas NO es palabra reservada en C++?", opts: ["while", "switch", "repeat"], ans: "repeat" },
      { q: "¬øQu√© instrucci√≥n imprime en pantalla en C++?", opts: ["printf()", "cout <<", "echo"], ans: "cout <<" }
    ];

    const ejerciciosRAP1 = [
      "Escribir un programa en C++ que declare variables de cada tipo primitivo y muestre sus valores.",
      "Crear un programa que solicite el nombre y la edad del usuario y los imprima en pantalla.",
      "Hacer un programa que defina una constante con const y la utilice en una operaci√≥n matem√°tica.",
      "Implementar un programa que valide identificadores v√°lidos e inv√°lidos."
    ];

    /* ================= RAP2 - Operadores ================= */
    const preguntasRAP2 = [
      { q: "¬øCu√°l es el operador de asignaci√≥n en C++?", opts: ["=", "==", ":="], ans: "=" },
      { q: "El operador '!=' significa:", opts: ["Mayor que", "Diferente de", "Igual a"], ans: "Diferente de" },
      { q: "¬øQu√© devuelve la expresi√≥n (9 < 12) && (2 <= 2)?", opts: ["true", "false", "error"], ans: "true" },
      { q: "¬øCu√°l tiene mayor precedencia?", opts: ["*", "+", "-"], ans: "*" },
      { q: "Resultado de 19 - 3 * 4 + 39", opts: ["61", "46", "34"], ans: "46" },
      { q: "¬øQu√© significa 'a += b'?", opts: ["a = b", "a = a + b", "a = a - b"], ans: "a = a + b" },
      { q: "El operador l√≥gico OR en C++ es:", opts: ["&&", "||", "!"], ans: "||" },
      { q: "La funci√≥n sqrt(x) calcula:", opts: ["Potencia", "Ra√≠z cuadrada", "Logaritmo"], ans: "Ra√≠z cuadrada" },
      { q: "¬øQu√© tipo de dato devuelve una expresi√≥n relacional?", opts: ["int", "bool", "float"], ans: "bool" },
      { q: "El operador '%' devuelve:", opts: ["Cociente", "Residuo", "Potencia"], ans: "Residuo" },
      { q: "¬øCu√°l de estas funciones devuelve el valor m√°ximo entre dos n√∫meros?", opts: ["fmax", "sqrt", "pow"], ans: "fmax" },
      { q: "¬øQu√© funci√≥n redondea un n√∫mero hacia arriba?", opts: ["floor()", "ceil()", "round()"], ans: "ceil()" }
    ];

    const ejerciciosRAP2 = [
      "Programa que calcule el resultado de 25 % 4.",
      "Solicitar dos n√∫meros y mostrar el mayor usando operadores relacionales.",
      "Calcular la ra√≠z cuadrada y el valor m√°ximo entre dos n√∫meros usando <math.h>.",
      "Evaluar la expresi√≥n (5*3 + 8) - (12/4) y mostrar el resultado."
    ];

    /* ================= RAP3 - Estructuras de Control ================= */
    const preguntasRAP3 = [
      { q: "¬øQu√© valor devuelve una condici√≥n en C++?", opts: ["int", "bool", "float"], ans: "bool" },
      { q: "La estructura if se usa para:", opts: ["Ciclos", "Decisiones", "Importar librer√≠as"], ans: "Decisiones" },
      { q: "¬øQu√© palabra se usa para la condici√≥n falsa de un if?", opts: ["else", "default", "switch"], ans: "else" },
      { q: "¬øCu√°l es la sintaxis correcta de if-else?", opts: ["if(condici√≥n){} else {}", "if() else {}", "if{}else()"], ans: "if(condici√≥n){} else {}" },
      { q: "¬øQu√© instrucci√≥n se usa para m√∫ltiples caminos de decisi√≥n?", opts: ["switch", "goto", "while"], ans: "switch" },
      { q: "El estatuto switch eval√∫a:", opts: ["Valores m√∫ltiples", "Solo booleanos", "N√∫meros decimales"], ans: "Valores m√∫ltiples" },
      { q: "¬øQu√© palabra se usa para salir de un switch?", opts: ["stop", "exit", "break"], ans: "break" },
      { q: "¬øC√≥mo se llaman los if dentro de otros if?", opts: ["Condiciones secuenciales", "Condiciones anidadas", "Condiciones m√∫ltiples"], ans: "Condiciones anidadas" },
      { q: "El valor por defecto en switch se declara con:", opts: ["case 0", "default", "else"], ans: "default" },
      { q: "¬øQu√© estructura usar√≠a para verificar si dos n√∫meros son iguales?", opts: ["if-else", "switch", "for"], ans: "if-else" },
      { q: "¬øQu√© operador l√≥gico se usa en condiciones compuestas?", opts: ["&& y ||", "+ y -", "++ y --"], ans: "&& y ||" },
      { q: "En un if(condici√≥n), la condici√≥n debe ser:", opts: ["Un n√∫mero", "Una expresi√≥n booleana", "Una cadena"], ans: "Una expresi√≥n booleana" }
    ];

    const ejerciciosRAP3 = [
      "Programa que lea dos n√∫meros y determine si son iguales, mayores o menores.",
      "Programa que valide si una calificaci√≥n est√° entre 0 y 5 y muestre aprobado/reprobado.",
      "Implementar un men√∫ con switch que permita elegir operaciones matem√°ticas.",
      "Programa que dado un n√∫mero del 1 al 7 muestre el d√≠a de la semana con switch."
    ];

    /* ================= RAP4 - Ciclos ================= */
    const preguntasRAP4 = [
      { q: "El ciclo while ejecuta instrucciones:", opts: ["Una sola vez", "Mientras la condici√≥n sea verdadera", "Siempre"], ans: "Mientras la condici√≥n sea verdadera" },
      { q: "¬øQu√© ciclo garantiza al menos una ejecuci√≥n?", opts: ["while", "do while", "for"], ans: "do while" },
      { q: "El ciclo for se usa cuando:", opts: ["Se desconoce la cantidad de repeticiones", "Se conoce la cantidad de repeticiones", "Nunca se conoce"], ans: "Se conoce la cantidad de repeticiones" },
      { q: "¬øCu√°l es el orden de la estructura for?", opts: ["Inicializaci√≥n, condici√≥n, incremento", "Condici√≥n, inicializaci√≥n, incremento", "Incremento, inicializaci√≥n, condici√≥n"], ans: "Inicializaci√≥n, condici√≥n, incremento" },
      { q: "¬øQu√© instrucci√≥n finaliza un ciclo inmediatamente?", opts: ["continue", "exit", "break"], ans: "break" },
      { q: "¬øQu√© ocurre si la condici√≥n de un while nunca se vuelve falsa?", opts: ["Error de sintaxis", "Ciclo infinito", "Termina solo"], ans: "Ciclo infinito" },
      { q: "¬øQu√© ciclo eval√∫a la condici√≥n al final?", opts: ["while", "for", "do while"], ans: "do while" },
      { q: "¬øQu√© palabra reservada permite saltar a la siguiente iteraci√≥n?", opts: ["next", "continue", "skip"], ans: "continue" },
      { q: "¬øCu√°l es la variable que controla un ciclo for?", opts: ["Contador", "Acumulador", "Constante"], ans: "Contador" },
      { q: "¬øCu√°l es el uso principal de los bucles en programaci√≥n?", opts: ["Tomar decisiones", "Repetir instrucciones", "Declarar variables"], ans: "Repetir instrucciones" },
      { q: "¬øCu√°l es un riesgo de los ciclos infinitos?", opts: ["Optimizaci√≥n", "Consumo excesivo de recursos", "Mayor velocidad"], ans: "Consumo excesivo de recursos" },
      { q: "El ciclo while requiere que:", opts: ["La condici√≥n sea booleana", "La condici√≥n sea num√©rica", "No tenga condici√≥n"], ans: "La condici√≥n sea booleana" }
    ];

    const ejerciciosRAP4 = [
      "Programa que calcule la suma de n√∫meros pares del 1 al 100 usando while.",
      "Programa que lea 5 notas y calcule el promedio con do while.",
      "Programa que solicite 10 n√∫meros y cuente cu√°ntos son mayores a 50 usando for.",
      "Programa que implemente un ciclo infinito controlado por el usuario."
    ];

    /* ================= Variables globales ================= */
    let preguntasSeleccionadas = [];
    let respuestasUsuario = [];
    const totalPreguntas = 40;
    const puntosPorPregunta = 100 / totalPreguntas;

    const rapInfo = {
      rap1: { title: "RAP1 - Fundamentos", description: "Conceptos b√°sicos de C++", icon: "1" },
      rap2: { title: "RAP2 - Operadores", description: "Operadores y expresiones", icon: "2" },
      rap3: { title: "RAP3 - Control", description: "Estructuras de decisi√≥n", icon: "3" },
      rap4: { title: "RAP4 - Ciclos", description: "Estructuras repetitivas", icon: "4" }
    };

    /* ================= Funciones principales ================= */
    function iniciarQuiz() {
      const nombre = document.getElementById("nombre").value.trim();
      const documento = document.getElementById("documento").value.trim();
      const clave = document.getElementById("clave").value;

      if (!nombre || !documento || !clave) { 
        alert("Complete todos los campos (nombre, documento y clave)");  
        return; 
      }

        if (clave !== "programaci√≥n.c++") {
          alert("‚ùå Clave incorrecta. Intente de nuevo.");
          return;
        }
       document.getElementById("formulario").classList.add("hidden");

      // Seleccionar 10 preguntas aleatorias de cada RAP
      function elegirPreguntas(array) {
        return [...array].sort(() => Math.random() - 0.5).slice(0, 10);
      }

      const rap1Selected = elegirPreguntas(preguntasRAP1);
      const rap2Selected = elegirPreguntas(preguntasRAP2);
      const rap3Selected = elegirPreguntas(preguntasRAP3);
      const rap4Selected = elegirPreguntas(preguntasRAP4);

      preguntasSeleccionadas = [
        ...rap1Selected.map(p => ({...p, rap: 'rap1'})),
        ...rap2Selected.map(p => ({...p, rap: 'rap2'})),
        ...rap3Selected.map(p => ({...p, rap: 'rap3'})),
        ...rap4Selected.map(p => ({...p, rap: 'rap4'}))
      ];

      // Inicializar array de respuestas
      respuestasUsuario = new Array(totalPreguntas).fill(null);

      mostrarPreguntas();
      document.getElementById("quiz").classList.remove("hidden");
      actualizarProgreso();
    }

    function mostrarPreguntas() {
      let quizHTML = "";
      let currentRap = "";
      let questionIndex = 0;

      preguntasSeleccionadas.forEach((pregunta, index) => {
        // Crear nueva secci√≥n RAP si es necesario
        if (pregunta.rap !== currentRap) {
          if (currentRap !== "") {
            quizHTML += "</div>"; // Cerrar secci√≥n anterior
          }
          currentRap = pregunta.rap;
          const rapData = rapInfo[currentRap];
          quizHTML += `
            <div class="rap-section ${currentRap}">
              <div class="rap-header">
                <div class="rap-icon">${rapData.icon}</div>
                <div>
                  <div class="rap-title">${rapData.title}</div>
                  <div class="rap-description">${rapData.description}</div>
                </div>
              </div>
          `;
        }

        // Mezclar opciones aleatoriamente
        const opciones = [...pregunta.opts].sort(() => Math.random() - 0.5);
        
        quizHTML += `
          <div class="question" id="question-${index}">
            <div style="display: flex; align-items: flex-start;">
              <span class="question-number">${index + 1}</span>
              <div style="flex: 1;">
                <div class="question-text">${pregunta.q}</div>
                <div class="options">
                  ${opciones.map(opcion => `
                    <div class="option" onclick="seleccionarRespuesta(${index}, '${opcion}')">
                      <input type="radio" name="q${index}" value="${opcion}" id="q${index}_${opcion}">
                      <label for="q${index}_${opcion}">${opcion}</label>
                    </div>
                  `).join("")}
                </div>
              </div>
            </div>
          </div>
        `;
      });

      if (currentRap !== "") {
        quizHTML += "</div>"; // Cerrar √∫ltima secci√≥n
      }

      document.getElementById("quizContent").innerHTML = quizHTML;
    }

    function seleccionarRespuesta(index, respuesta) {
      respuestasUsuario[index] = respuesta;
      
      // Actualizar UI
      const questionDiv = document.getElementById(`question-${index}`);
      questionDiv.classList.remove('error');
      
      // Remover selecci√≥n anterior
      questionDiv.querySelectorAll('.option').forEach(opt => opt.classList.remove('selected'));
      
      // Marcar nueva selecci√≥n
      event.currentTarget.classList.add('selected');
      
      actualizarProgreso();
    }

    function actualizarProgreso() {
      const respondidas = respuestasUsuario.filter(r => r !== null).length;
      const porcentaje = (respondidas / totalPreguntas) * 100;
      
      document.getElementById("progressFill").style.width = porcentaje + "%";
      document.getElementById("progressText").textContent = `Pregunta ${respondidas} de ${totalPreguntas}`;
    }

    function validarRespuestas() {
      const preguntasSinResponder = [];
      
      respuestasUsuario.forEach((respuesta, index) => {
        const questionDiv = document.getElementById(`question-${index}`);
        if (respuesta === null) {
          preguntasSinResponder.push(index + 1);
          questionDiv.classList.add('error');
          questionDiv.scrollIntoView({ behavior: 'smooth', block: 'center' });
        } else {
          questionDiv.classList.remove('error');
        }
      });

      if (preguntasSinResponder.length > 0) {
        const validationMessage = document.getElementById("validationMessage");
        const missingQuestions = document.getElementById("missingQuestions");
        
        missingQuestions.innerHTML = `<br><strong>Preguntas sin responder:</strong> ${preguntasSinResponder.join(', ')}`;
        validationMessage.classList.add('show');
        
        // Scroll to first unanswered question
        setTimeout(() => {
          const firstUnanswered = document.getElementById(`question-${preguntasSinResponder[0] - 1}`);
          firstUnanswered.scrollIntoView({ behavior: 'smooth', block: 'center' });
        }, 100);
        
        return false;
      }
      
      document.getElementById("validationMessage").classList.remove('show');
      return true;
    }

    function finalizarQuiz() {
      if (!validarRespuestas()) {
        return;
      }

      const nombre = document.getElementById("nombre").value;
      const documento = document.getElementById("documento").value;

      let score = 0;
      let correctas = 0;
      let detallesRAP = {
        rap1: { correctas: 0, total: 0 },
        rap2: { correctas: 0, total: 0 },
        rap3: { correctas: 0, total: 0 },
        rap4: { correctas: 0, total: 0 }
      };

      preguntasSeleccionadas.forEach((pregunta, index) => {
        const respuestaUsuario = respuestasUsuario[index];
        detallesRAP[pregunta.rap].total++;
        
        if (respuestaUsuario === pregunta.ans) {
          score += puntosPorPregunta;
          correctas++;
          detallesRAP[pregunta.rap].correctas++;
        }
      });

      const aprueba = score >= 70;
      const scoreClass = aprueba ? 'pass' : 'fail';

      document.getElementById("quiz").classList.add("hidden");
      
      // Mostrar resultado detallado
      document.getElementById("resultado").innerHTML = `
        <div class="result-card">
          <h3>üìã Resultado de la Evaluaci√≥n</h3>
          <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin: 20px 0; text-align: left;">
            <div><strong>Nombre:</strong> ${nombre}</div>
            <div><strong>Documento:</strong> ${documento}</div>
          </div>
          
          <div class="result-score ${scoreClass}">${score.toFixed(1)}/100</div>
          <div class="result-status ${scoreClass}">
            ${aprueba ? '‚úÖ APROBADO' : '‚ùå REPROBADO'}
          </div>
          
          <div style="background: #f8f9fa; border-radius: 8px; padding: 20px; margin: 20px 0;">
            <h4 style="margin-bottom: 15px; color: #2c3e50;">üìä Detalle por M√≥dulos</h4>
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
              ${Object.entries(detallesRAP).map(([rap, datos]) => {
                const porcentaje = (datos.correctas / datos.total) * 100;
                const rapData = rapInfo[rap];
                return `
                  <div style="background: white; padding: 15px; border-radius: 8px; border-left: 4px solid ${getColorByRAP(rap)};">
                    <div style="font-weight: bold; color: #2c3e50; margin-bottom: 5px;">${rapData.title}</div>
                    <div style="font-size: 1.2em; font-weight: bold; color: ${porcentaje >= 70 ? '#2ecc71' : '#e74c3c'};">
                      ${datos.correctas}/${datos.total} (${porcentaje.toFixed(0)}%)
                    </div>
                  </div>
                `;
              }).join('')}
            </div>
          </div>
          
          <div style="background: #e8f4fd; padding: 15px; border-radius: 8px; margin: 20px 0;">
            <strong>üìà Resumen:</strong> ${correctas} respuestas correctas de ${totalPreguntas} preguntas
          </div>
          
          ${aprueba ? 
            '<div style="color: #2ecc71; font-weight: bold;">¬°Felicitaciones! Ha aprobado la evaluaci√≥n.</div>' : 
            '<div style="color: #e74c3c; font-weight: bold;">Debe estudiar m√°s para aprobar. Repase los temas con menor puntuaci√≥n.</div>'
          }
        </div>
      `;
      document.getElementById("resultado").classList.remove("hidden");

      // Mostrar ejercicios pr√°cticos
      mostrarEjercicios();
      document.getElementById("upload").classList.remove("hidden");
    }

    function getColorByRAP(rap) {
      const colors = {
        rap1: '#e74c3c',
        rap2: '#f39c12',
        rap3: '#3498db',
        rap4: '#2ecc71'
      };
      return colors[rap] || '#6c757d';
    }

    function mostrarEjercicios() {
      const todosEjercicios = [
        ...ejerciciosRAP1.map(e => ({ejercicio: e, rap: 'RAP1 - Fundamentos'})),
        ...ejerciciosRAP2.map(e => ({ejercicio: e, rap: 'RAP2 - Operadores'})),
        ...ejerciciosRAP3.map(e => ({ejercicio: e, rap: 'RAP3 - Control'})),
        ...ejerciciosRAP4.map(e => ({ejercicio: e, rap: 'RAP4 - Ciclos'}))
      ];
      
      const seleccionados = [...todosEjercicios].sort(() => Math.random() - 0.5).slice(0, 4);
      
      document.getElementById("ejercicios").innerHTML = `
        <div class="exercises">
          <h3>üíª Ejercicios Pr√°cticos Asignados</h3>
          <p style="margin-bottom: 20px; color: #6c757d;">
            Complete los siguientes ejercicios y s√∫balos en formato comprimido (.zip o .rar):
          </p>
          <div style="display: grid; gap: 15px;">
            ${seleccionados.map((item, index) => `
              <div style="background: white; padding: 20px; border-radius: 8px; border-left: 4px solid #667eea;">
                <div style="display: flex; align-items: center; margin-bottom: 10px;">
                  <span style="background: #667eea; color: white; width: 25px; height: 25px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold; margin-right: 10px; font-size: 14px;">
                    ${index + 1}
                  </span>
                  <span style="font-size: 0.9em; color: #6c757d; font-weight: bold;">
                    ${item.rap}
                  </span>
                </div>
                <div style="color: #2c3e50; line-height: 1.6;">
                  ${item.ejercicio}
                </div>
              </div>
            `).join('')}
          </div>
          
          <div style="background: #fff3cd; border: 1px solid #ffeaa7; color: #856404; padding: 15px; border-radius: 8px; margin-top: 20px;">
            <strong>üìù Instrucciones:</strong>
            <ul style="margin: 10px 0 0 20px; line-height: 1.6;">
              <li>Cree un archivo .cpp para cada ejercicio</li>
              <li>Documente su c√≥digo con comentarios explicativos</li>
              <li>Aseg√∫rese de que los programas compilen sin errores</li>
              <li>Incluya ejemplos de ejecuci√≥n en comentarios</li>
              <li>Comprima todos los archivos en un solo .zip o .rar</li>
            </ul>
          </div>
        </div>
      `;
      document.getElementById("ejercicios").classList.remove("hidden");
    }

    // Event listener para mejorar la interacci√≥n
    document.addEventListener('DOMContentLoaded', function() {
      // Mejorar la accesibilidad del teclado
      document.addEventListener('keydown', function(e) {
        if (e.key === 'Enter' && e.target.type === 'radio') {
          e.target.click();
        }
      });

      // Validaci√≥n en tiempo real del formulario
      const nombreInput = document.getElementById('nombre');
      const documentoInput = document.getElementById('documento');
      
      [nombreInput, documentoInput].forEach(input => {
        input.addEventListener('input', function() {
          if (this.value.trim()) {
            this.style.borderColor = '#2ecc71';
          } else {
            this.style.borderColor = '#e1e8ed';
          }
        });
      });

      // Prevenir env√≠o accidental del formulario
      document.addEventListener('keydown', function(e) {
        if (e.key === 'Enter' && !e.target.matches('button, input[type="submit"]')) {
          e.preventDefault();
        }
      });
    });

    // Funci√≥n para reiniciar la evaluaci√≥n
    function reiniciarEvaluacion() {
      if (confirm('¬øEst√° seguro que desea reiniciar la evaluaci√≥n? Se perder√°n todos los datos ingresados.')) {
        location.reload();
      }
    }

    // Prevenir navegaci√≥n accidental
    window.addEventListener('beforeunload', function(e) {
      if (!document.getElementById('quiz').classList.contains('hidden')) {
        e.preventDefault();
        e.returnValue = '';
        return 'Tiene una evaluaci√≥n en progreso. ¬øEst√° seguro que desea salir?';
      }
    });

    // Auto-save en localStorage (opcional - comentado por restricciones)
    /*
    function guardarProgreso() {
      const progreso = {
        nombre: document.getElementById('nombre').value,
        documento: document.getElementById('documento').value,
        respuestas: respuestasUsuario,
        preguntas: preguntasSeleccionadas
      };
      localStorage.setItem('evaluacion_cpp_progreso', JSON.stringify(progreso));
    }
    */

    console.log('üéì Sistema de Evaluaci√≥n C++ cargado correctamente');
    console.log('üìö M√≥dulos: RAP1-Fundamentos, RAP2-Operadores, RAP3-Control, RAP4-Ciclos');
    console.log('‚úÖ Validaci√≥n completa implementada');
  </script>
</body>
</html>
        
